![](/img/GeNNy_–_Using_GNNs_for_Refactoring_P4_Programs.png)

# GeNNy – Using GNNs for Refactoring P4 Programs

> _Project under active development since **January 2025**, with ongoing work planned through **at least May 2026**._

## Overview

**GeNNy** is a research-oriented project that explores the use of **Graph Neural Networks (GNNs)** for **automated syntactic refactorings** in programs written in the [P4 language](https://p4.org/). The project builds on top of the [P4Query](https://doi.org/10.33039/ami.2023.03.002) static analysis framework, developed at the **Department of Programming Languages and Compilers** at **Eötvös Loránd University (ELTE), Faculty of Informatics**.

### What does this project do?

Using the intermediate **graph-based representations** generated by `P4Query` (such as Abstract Syntax Trees (ASTs) and control flow graphs), the project trains GNN-based models to learn and apply various **syntactic-level refactorings** on P4 programs. ASTs are exported as JSON files and used as the primary input format for training.

## Goals

The primary aim of the project is to leverage deep learning – particularly graph-based learning – to understand and transform code at the syntax level, focusing on tasks such as:

- **Variable renaming**: Recognize all occurrences of a variable and rename them consistently.
- **Parameter reordering**: Learn to reorder parameters in function calls to match a canonical or optimal ordering.
- **Empty `else` block detection**: Identify unnecessary or unused `else` branches in control structures.

All transformations are **purely syntactic** with the goal of **code standardization and optimization**, without altering program semantics.

## Methodology

GeNNy uses an **autoencoder architecture** implemented in [PyTorch](http://arxiv.org/abs/1912.01703) to train the GNNs. The training strategy is as follows:

- During each training **epoch**, the input AST graph is **partially pruned**.
- Early epochs remove **leaf nodes**, while later epochs remove **larger subgraphs**.
- This forces the model to **reconstruct the full graph**, learning robust **structural embeddings** and contextual information.
- Normalization and preprocessing steps ensure consistent graph input structure for GNN training.

The approach is inspired by the idea that a model forced to learn under increasingly difficult conditions will develop deeper structural understanding.

## Technologies

- **PyTorch** – Neural network implementation and training engine.
- **P4Query** – Static analysis tool for P4 programs.
- **Gremlin** – Internal query representation used by P4Query.
- **JSON** – Export format for ASTs and control flow graphs.

